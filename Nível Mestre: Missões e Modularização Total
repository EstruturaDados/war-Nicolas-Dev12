#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>

#define QTD 5

typedef struct {
    char nome[50];
    char corExercito[20];
    int tropas;
} Territorio;

// --- Prototipagem das fun√ß√µes ---
void inicializar(Territorio *t);
void exibirMapa(const Territorio *t);
void atacar(Territorio *t);
int verificarMissao(const Territorio *t);
void menu();

// --- Fun√ß√£o principal ---
int main() {
    srand(time(NULL));
    Territorio territorios[QTD];
    inicializar(territorios);

    int opcao;
    do {
        menu();
        scanf("%d", &opcao);
        getchar();

        switch (opcao) {
            case 1:
                atacar(territorios);
                break;
            case 2:
                if (verificarMissao(territorios))
                    printf("\n Miss√£o Cumprida! Voc√™ venceu o jogo!\n");
                else
                    printf("\n Ainda h√° miss√µes pendentes.\n");
                break;
            case 0:
                printf("\nSaindo do jogo... \n");
                break;
            default:
                printf("Op√ß√£o inv√°lida!\n");
        }
    } while (opcao != 0);

    return 0;
}

// --- Implementa√ß√£o das fun√ß√µes ---
void menu() {
    printf("\n=== MENU PRINCIPAL ===\n");
    printf("1 - Atacar\n");
    printf("2 - Verificar Miss√£o\n");
    printf("0 - Sair\n");
    printf("Escolha: ");
}

// Inicializa territ√≥rios automaticamente
void inicializar(Territorio *t) {
    strcpy(t[0].nome, "Brasil");
    strcpy(t[1].nome, "Canad√°");
    strcpy(t[2].nome, "Jap√£o");
    strcpy(t[3].nome, "Egito");
    strcpy(t[4].nome, "Alemanha");

    strcpy(t[0].corExercito, "Vermelho");
    strcpy(t[1].corExercito, "Verde");
    strcpy(t[2].corExercito, "Azul");
    strcpy(t[3].corExercito, "Amarelo");
    strcpy(t[4].corExercito, "Verde");

    for (int i = 0; i < QTD; i++)
        t[i].tropas = rand() % 5 + 2;

    printf("\nüåç Territ√≥rios Iniciados!\n");
    exibirMapa(t);
}

void exibirMapa(const Territorio *t) {
    printf("\n=== ESTADO ATUAL DO MAPA ===\n");
    for (int i = 0; i < QTD; i++) {
        printf("%d - %s | Ex√©rcito: %s | Tropas: %d\n",
               i + 1, t[i].nome, t[i].corExercito, t[i].tropas);
    }
}

void atacar(Territorio *t) {
    int a, d;
    exibirMapa(t);

    printf("\nEscolha territ√≥rio atacante (1-5): ");
    scanf("%d", &a);
    printf("Escolha territ√≥rio defensor (1-5): ");
    scanf("%d", &d);

    if (a < 1 || a > 5 || d < 1 || d > 5 || a == d) {
        printf("‚ùå Escolha inv√°lida!\n");
        return;
    }

    int dadoA = rand() % 6 + 1;
    int dadoD = rand() % 6 + 1;

    printf("\n Dados ‚Üí Ataque: %d | Defesa: %d\n", dadoA, dadoD);

    if (dadoA > dadoD) {
        t[d - 1].tropas--;
        printf(" %s venceu o ataque!\n", t[a - 1].nome);
        if (t[d - 1].tropas <= 0) {
            printf("üè¥ %s foi conquistado por %s!\n",
                   t[d - 1].nome, t[a - 1].corExercito);
            strcpy(t[d - 1].corExercito, t[a - 1].corExercito);
            t[d - 1].tropas = 1;
        }
    } else {
        printf(" %s defendeu com sucesso!\n", t[d - 1].nome);
    }
}

// Verifica se miss√µes foram cumpridas
int verificarMissao(const Territorio *t) {
    int conquistados = 0;
    int verdes = 0;

    for (int i = 0; i < QTD; i++) {
        if (strcmp(t[i].corExercito, "Verde") == 0)
            verdes++;
        if (strcmp(t[i].corExercito, "Vermelho") == 0)
            conquistados++;
    }

    // Miss√µes:
    // 1. Destruir ex√©rcito verde (nenhum territ√≥rio verde)
    // 2. Conquistar 3 territ√≥rios vermelhos
    if (verdes == 0 || conquistados >= 3)
        return 1;

    return 0;
}

    } while (opcao != 0);

    return 0;
}
